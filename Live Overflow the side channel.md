## Task:

You have intercepted the power consumption from a wizards wand who is communicating to the enemy. Gandalf says that these wands use some kind of square and multiply algorithm based on the bit of the exponent when represented in binary. Find the key and stop the attack.

[Voltage](Resources%20provided/Voltage.txt)

```txt
25, 25, 28, 29, 29, 26, 28, 30, 29, 25, 51, 52, 54, 54, 55, 25, 30, 27, 30, 29, 28, 26, 26, 25, 30, 30, 27, 26, 28, 29, 51, 50, 55, 51, 52, 29, 28, 27, 27, 27, 30, 29, 30, 26, 26, 53, 53, 54, 52, 52, 26, 29, 28, 27, 27, 55, 54, 50, 51, 50, 30, 26, 27, 29, 28, 25, 28, 29, 26, 28, 50, 54, 52, 51, 51, 29, 29, 29, 26, 25, 29, 25, 29, 29, 29, 55, 50, 53, 53, 53, 30, 25, 28, 29, 30, 30, 29, 27, 26, 30, 26, 27, 25, 29, 25, 26, 27, 28, 29, 30, 26, 30, 26, 26, 28, 26, 30, 28, 26, 26, 50, 52, 55, 53, 52, 27, 28, 25, 28, 30, 26, 26, 26, 27, 30, 25, 27, 29, 27, 27, 55, 53, 55, 51, 55, 30, 27, 30, 26, 28, 53, 55, 55, 53, 51, 26, 28, 29, 29, 29, 30, 28, 28, 30, 26, 53, 55, 52, 51, 54, 27, 27, 30, 30, 26, 28, 29, 28, 28, 27, 50, 50, 51, 53, 53, 29, 30, 28, 25, 29, 27, 26, 26, 29, 26, 26, 30, 26, 25, 25, 27, 29, 27, 30, 25, 55, 53, 53, 54, 53, 28, 30, 26, 25, 30, 53, 52, 52, 53, 55, 25, 27, 30, 28, 29, 52, 55, 50, 51, 53, 25, 29, 26, 29, 30, 28, 30, 30, 25, 28, 53, 55, 50, 52, 50, 25, 26, 26, 28, 25, 28, 27, 28, 26, 29, 52, 50, 55, 51, 55, 28, 30, 29, 28, 25, 53, 53, 51, 54, 52, 29, 28, 27, 27, 25, 55, 55, 50, 55, 54, 30, 30, 29, 26, 26, 55, 55, 51, 51, 53, 29, 27, 28, 29, 25, 54, 51, 51, 52, 50, 25, 29, 26, 27, 28, 27, 26, 27, 29, 30, 54, 52, 55, 55, 51, 29, 30, 29, 29, 30, 27, 26, 30, 30, 25, 28, 28, 28, 28, 28, 28, 27, 25, 30, 30, 25, 28, 28, 25, 30, 50, 53, 53, 55, 54, 30, 25, 30, 25, 30, 53, 54, 55, 52, 53, 30, 28, 26, 26, 28, 28, 26, 29, 27, 29, 52, 50, 55, 55, 54, 27, 26, 28, 29, 30, 30, 29, 27, 29, 28, 54, 54, 54, 54, 50, 26, 28, 26, 29, 29, 29, 28, 29, 29, 29, 53, 54, 50, 55, 52, 27, 26, 26, 25, 26, 25, 28, 28, 30, 29, 25, 26, 27, 28, 27, 27, 28, 26, 28, 29, 53, 55, 53, 55, 54, 26, 30, 25, 29, 27, 30, 28, 27, 29, 25, 27, 27, 27, 30, 28, 29, 27, 29, 27, 26, 51, 52, 50, 54, 50, 28, 28, 29, 28, 27, 50, 52, 53, 54, 55, 25, 25, 29, 30, 28, 28, 29, 28, 25, 26, 25, 25, 28, 26, 25, 50, 53, 52, 51, 55, 26, 28, 27, 29, 30, 51, 51, 54, 50, 54, 30, 30, 26, 25, 25, 50, 52, 51, 50, 53, 29, 30, 25, 28, 30, 50, 50, 50, 51, 51, 28, 28, 25, 28, 26, 28, 27, 28, 30, 26, 52, 51, 53, 50, 52, 27, 29, 29, 25, 27, 55, 52, 55, 52, 50, 28, 25, 25, 30, 28, 26, 25, 30, 26, 25, 30, 25, 26, 30, 30, 55, 52, 55, 51, 51, 25, 25, 26, 26, 26, 54, 53, 50, 52, 51, 30, 25, 27, 29, 26, 26, 26, 27, 27, 27, 29, 29, 30, 29, 25, 54, 54, 54, 55, 54, 30, 28, 26, 29, 30, 26, 25, 28, 29, 27, 26, 28, 27, 28, 25, 27, 28, 29, 25, 29, 50, 50, 54, 55, 53, 25, 25, 27, 29, 30, 55, 54, 53, 54, 55, 30, 29, 27, 27, 27, 30, 30, 30, 27, 27, 26, 25, 30, 27, 26, 30, 25, 27, 30, 25, 54, 51, 55, 55, 54, 26, 25, 30, 28, 29, 29, 28, 30, 28, 25, 53, 52, 53, 52, 52, 29, 27, 30, 25, 25, 50, 51, 50, 55, 50, 26, 27, 25, 27, 25, 28, 30, 25, 29, 29, 25, 27, 29, 29, 27, 55, 52, 52, 50, 51, 27, 27, 29, 26, 29, 55, 52, 50, 51, 55, 27, 29, 30, 30, 30, 26, 27, 29, 27, 30, 29, 30, 28, 25, 27, 26, 30, 26, 27, 28, 54, 51, 50, 50, 55, 26, 29, 30, 28, 26, 55, 51, 53, 54, 51, 30, 30, 25, 26, 26, 26, 27, 28, 25, 26, 28, 29, 28, 30, 27, 26, 26, 26, 25, 28, 29, 25, 26, 27, 27, 28, 25, 29, 30, 26, 52, 52, 53, 51, 51, 30, 26, 28, 28, 30, 55, 51, 54, 54, 55, 30, 29, 30, 30, 29, 25, 25, 25, 30, 28, 28, 29, 30, 28, 26, 50, 50, 54, 55, 50, 29, 25, 26, 25, 28, 30, 28, 25, 27, 26, 25, 27, 27, 28, 30, 26, 25, 26, 29, 29, 52, 54, 53, 53, 55, 25, 26, 30, 27, 30, 52, 53, 55, 55, 50, 29, 28, 29, 27, 27, 25, 29, 26, 30, 25, 28, 26, 30, 28, 29, 28, 26, 30, 25, 26, 26, 29, 30, 26, 27, 52, 54, 52, 54, 54, 26, 29, 26, 29, 28, 25, 30, 30, 26, 27, 25, 25, 25, 25, 25, 53, 52, 50, 50, 51, 26, 25, 28, 28, 28, 50, 54, 52, 55, 50, 29, 27, 29, 27, 25, 27, 28, 28, 30, 30, 26, 30, 26, 27, 26, 30, 29, 26, 27, 27, 25, 26, 30, 25, 29, 26, 28, 27, 26, 27, 55, 50, 53, 52, 54, 25, 27, 30, 30, 29, 54, 53, 53, 52, 51, 28, 25, 28, 25, 25, 27, 26, 28, 30, 25, 26, 28, 30, 29, 27, 30, 28, 30, 30, 27, 54, 53, 54, 53, 52, 25, 25, 29, 27, 30, 54, 54, 52, 52, 54, 27, 25, 29, 29, 27, 25, 27, 30, 25, 29, 25, 30, 25, 27, 27, 53, 53, 53, 53, 53, 30, 30, 25, 26, 28, 51, 55, 50, 54, 50, 29, 27, 26, 28, 26, 30, 28, 28, 27, 25, 26, 25, 26, 25, 25, 29, 30, 29, 26, 25, 27, 28, 27, 30, 30, 29, 26, 30, 29, 26, 54, 52, 51, 53, 50, 26, 26, 25, 27, 25, 50, 50, 55, 54, 52, 30, 27, 27, 28, 26, 25, 26, 29, 30, 29, 28, 26, 25, 28, 26, 50, 52, 50, 51, 54, 26, 28, 30, 28, 28, 29, 27, 27, 27, 29, 27, 25, 27, 30, 25, 26, 25, 25, 27, 29, 27, 27, 27, 25, 27, 53, 55, 51, 54, 52, 26, 27, 30, 26, 29, 50, 51, 52, 51, 54, 26, 25, 27, 30, 27, 29, 26, 30, 26, 30, 30, 30, 29, 27, 29, 51, 52, 52, 55, 54, 30, 25, 25, 30, 30, 53, 52, 52, 55, 51, 29, 27, 25, 29, 26, 28, 28, 30, 26, 28, 30, 26, 29, 27, 29, 52, 51, 55, 53, 55, 30, 27, 27, 30, 28, 55, 51, 55, 54, 52, 30, 28, 30, 27, 27, 25, 26, 29, 28, 28, 52, 51, 51, 51, 54, 30, 27, 29, 29, 29, 28, 25, 29, 26, 26, 51, 54, 53, 54, 50, 27, 26, 25, 29, 25, 26, 25, 29, 26, 29, 26, 30, 26, 26, 27, 50, 51, 54, 55, 50, 25, 30, 30, 25, 28, 54, 50, 51, 51, 53, 30, 26, 28, 26, 26, 30, 27, 26, 29, 29, 52, 55, 55, 52, 50, 29, 28, 28, 30, 30, 28, 25, 28, 27, 30, 28, 25, 29, 30, 29, 26, 26, 29, 30, 25, 26, 30, 27, 25, 30, 52, 51, 52, 51, 53, 27, 25, 27, 27, 27, 53, 52, 50, 50, 55, 25, 26, 25, 29, 25, 29, 28, 26, 25, 26, 26, 27, 30, 27, 30, 26, 26, 27, 30, 29, 54, 52, 50, 54, 52, 26, 25, 29, 28, 30, 27, 29, 26, 27, 26, 53, 52, 55, 53, 55, 28, 29, 25, 25, 30, 54, 55, 51, 50, 52, 29, 30, 30, 29, 27, 26, 27, 30, 26, 27, 29, 29, 28, 27, 26, 52, 55, 53, 55, 55, 26, 30, 27, 30, 27, 53, 53, 50, 50, 54, 28, 25, 26, 25, 29, 30, 25, 25, 27, 28, 26, 27, 28, 29, 25, 50, 53, 52, 52, 51, 29, 26, 30, 30, 27, 54, 51, 52, 55, 52, 29, 30, 26, 25, 30, 30, 27, 26, 28, 28, 25, 25, 30, 30, 29, 51, 50, 53, 50, 54, 26, 28, 28, 26, 26, 27, 26, 27, 27, 26, 25, 30, 26, 27, 27, 25, 29, 29, 30, 25, 54, 52, 53, 55, 54, 27, 30, 28, 27, 28, 55, 51, 52, 50, 54, 28, 29, 29, 28, 29, 51, 55, 53, 51, 55, 30, 26, 26, 28, 29, 52, 51, 51, 53, 51, 30, 28, 27, 25, 26, 54, 51, 54, 53, 51, 26, 28, 30, 27, 26, 25, 27, 25, 27, 29, 50, 54, 50, 53, 52

```

## Points: 400

## SOLUTION:

We are given a file containing value of voltage at different times. The title and description hints towards a [youtube video](https://youtu.be/bFfyROX7V0s) by LiveOverflow. His video describes what's going on. Basically single low volt is 0 and low volt follwed by high volt is 1 due to the square and multiply algorithm.

I wrote a program to decode the key from the volts.
```python
# volt.py

file = open('Voltage.txt','r')
volts = file.read()
file.close()
volts = volts.split(', ')
volts = [ 0 if int(volts[i]) < 40 else 1 for i in range(0,len(volts),5)]
i = 0
key = ''
while i < len(volts):
    if volts[i+1] == 1 and volts[i] == 0:
        key+= '1'
        i += 2
    else :
        key+='0'
        i += 1

for i in range(0, len(key), 8):
    print(chr(int(key[i:i+8],2)),end='')
```

On running this program, we get the flag.
```sh
[ssk@arch temp]$ python volt.py 
KPMG_CTF{21f0da0c0d3541fd}
```